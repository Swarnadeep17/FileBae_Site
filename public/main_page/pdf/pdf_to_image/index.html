<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Convert PDF to high-quality images with FileBae. Fast, free, privacy-first, with AI-powered OCR and customizable quality, resolution, and format." />
  <meta name="keywords" content="pdf to image, convert pdf to jpg, pdf to png, webp, tiff, image quality slider, dpi, free pdf converter, FileBae" />
  <meta name="author" content="FileBae">
  <title>PDF → Image | FileBae</title>
  <link rel="icon" href="../../../assets/favicon.png" type="image/png" />
  <style>
    body { margin:0; font-family:'Segoe UI',sans-serif; background:#fff; color:#111 }
    header { text-align:center; padding:2rem 1rem 1rem }
    h1 { font-size:2.2rem; margin-bottom:.5rem }
    h2 { font-weight:normal; font-size:1rem; color:#555 }
    .tool-container { max-width:900px; margin: auto; padding:2rem 1rem; }
    .upload-box { border:2px dashed #000; padding:2rem; border-radius:12px; background:#fafafa; }
    .upload-box input[type="file"] { display:block; margin:1rem auto }
    .options { margin-top:1.5rem; }
    .options label { display:block; margin:0.5rem 0; }
    .options select,
    .options input[type="number"],
    .options input[type="range"] { width:100%; margin-top:.3rem }
    button { background:#000; color:#fff; border:none; padding:.8rem 1.5rem; border-radius:6px; font-size:1rem; cursor:pointer; margin-top:1rem; display:block; width:100% }
    .progress-bar { width:100%; height:8px; background:#eee; border-radius:4px; overflow:hidden; margin:1.5rem 0; display:none }
    .progress-bar div { height:100%; width:0; background:#000; transition:width .2s ease }
    .thumbnails { display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:1rem; margin-top:2rem }
    .thumb { text-align:center }
    .thumb img { max-width:100%; border:1px solid #ccc; border-radius:6px }
    .ocr-text { max-width:900px; margin:2rem auto; }
    .ocr-text h3 { margin-bottom:.5rem }
    footer { text-align:center; padding:1rem; font-size:.9rem; background:#f5f5f5; border-top:1px solid #ddd }
    @media (max-width:600px){
      .options select,
      .options input[type="number"],
      .options input[type="range"],
      button { font-size:.9rem }
    }
  </style>
</head>
<body>

  <header>
    <h1>PDF → Image</h1>
    <h2>Customizable, lightning-fast PDF to image conversion</h2>
  </header>

  <section class="tool-container">
    <div class="upload-box">
      <form id="pdfForm" enctype="multipart/form-data">
        <p>Select your PDF (≤15 MB):</p>
        <input type="file" name="file" accept="application/pdf" required />

        <div class="options">
          <label>
            Output format:
            <select name="format">
              <option value="png">PNG</option>
              <option value="jpg">JPG</option>
              <option value="webp">WEBP</option>
              <option value="tiff">TIFF</option>
            </select>
          </label>
          <label>
            Quality: <span id="qualityVal">80</span>%
            <input type="range" name="quality" min="10" max="100" value="80" />
          </label>
          <label>
            Resolution (DPI):
            <input type="number" name="dpi" min="72" max="300" value="150" />
          </label>
          <label>
            <input type="checkbox" name="ocr" /> AI-Powered OCR (extract text)
          </label>
        </div>

        <button type="submit">Convert PDF to Image</button>
      </form>

      <div class="progress-bar" id="progressBar"><div></div></div>
    </div>

    <div class="thumbnails" id="thumbContainer"></div>
    <div class="ocr-text" id="ocrOutput"></div>
  </section>

  <footer>
    FileBae is built for humans. No logins. No noise. Just pure, efficient tools.
  </footer>

  <script>
    (function(){
      const form     = document.getElementById('pdfForm');
      const bar      = document.getElementById('progressBar');
      const fill     = bar.querySelector('div');
      const thumbs   = document.getElementById('thumbContainer');
      const ocrBox   = document.getElementById('ocrOutput');
      const quality  = form.quality;
      const qualityVal = document.getElementById('qualityVal');

      quality.addEventListener('input', ()=> qualityVal.textContent = quality.value);

      form.addEventListener('submit', async e => {
        e.preventDefault();
        thumbs.innerHTML = '';
        ocrBox.innerHTML = '';
        bar.style.display = 'block';
        fill.style.width = '0%';

        const file = form.file.files[0];
        if (!file) return alert('Please select a PDF file.');
        if (file.size > 15*1024*1024) {
          return alert('Free plan limit is 15 MB. Upgrade coming soon!');
        }

        const data = new FormData(form);
        const url  = '/api/pdf-to-image'; // rewrites to your function

        // simulate progress every 5%
        let pct = 0;
        const prog = setInterval(()=>{
          pct = Math.min(pct+5, 95);
          fill.style.width = pct+'%';
        }, 300);

        const res = await fetch(url, { method:'POST', body:data });
        clearInterval(prog);

        if (!res.ok) {
          bar.style.display='none';
          return alert('Conversion failed. Try again.');
        }

        const result = await res.json();
        fill.style.width = '100%';

        // thumbnails + auto-download
        result.images.forEach((img, i) => {
          const blob = Uint8Array.from(atob(img.base64), c=>c.charCodeAt(0));
          const fileBlob = new Blob([blob], { type: img.type });
          const link = document.createElement('a');
          link.href = URL.createObjectURL(fileBlob);
          link.download = img.name;

          // thumbnail
          const div = document.createElement('div');
          div.className = 'thumb';
          const image = new Image();
          image.src = link.href;
          image.alt = img.name;
          div.appendChild(image);
          thumbs.appendChild(div);

          // auto-download
          setTimeout(()=> link.click(), i * 500);
        });

        // OCR text
        if (form.ocr.checked && result.extractedText?.length) {
          const h3 = document.createElement('h3');
          h3.textContent = 'Extracted Text (OCR)';
          ocrBox.appendChild(h3);

          result.extractedText.forEach(p => {
            const block = document.createElement('pre');
            block.style.whiteSpace = 'pre-wrap';
            block.textContent = `Page ${p.page}:\n${p.text}`;
            ocrBox.appendChild(block);
          });
        }

        // cleanup message
        setTimeout(()=>{
          alert('Temporary files cleaned up on server.');
        }, 500);

        // hide progress after short delay
        setTimeout(()=> bar.style.display = 'none', 1000);
      });
    })();
  </script>

</body>
</html>
